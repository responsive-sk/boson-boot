# Root .htaccess - Protect sensitive files and directories

# Deny access to all files in root directory except public
<RequireAll>
    Require all denied
</RequireAll>

# Block access to sensitive files
<FilesMatch "\.(env|htaccess|htpasswd|ini|log|sh|sql|conf|bak|backup|swp|tmp|md)$">
    Require all denied
</FilesMatch>

# Block access to directories
RedirectMatch 404 ^/(src|templates|database|storage|vendor|tests)/.*$

# Block access to configuration files
<FilesMatch "(composer\.(json|lock)|package\.(json|lock)|\.env.*|migrate\.php)$">
    Require all denied
</FilesMatch>

# Block access to version control
<DirectoryMatch "\.(git|svn|hg)">
    Require all denied
</DirectoryMatch>

# Redirect all requests to public directory
RewriteEngine On
RewriteCond %{REQUEST_URI} !^/public/
RewriteRule ^(.*)$ /public/$1 [L,R=301]
